{
  "version": "2.2",
  "metadata": {
    "rules_version": "1.13.0"
  },
  "rules": [
    {
      "id": "rasp-003-001",
      "name": "SQL Injection",
      "tags": {
        "type": "sql_injection",
        "category": "exploit",
        "module": "rasp"
      },
      "conditions": [
        {
          "operator": "sqli_detector",
          "parameters": {
            "resource": [{ "address": "server.db.statement" }],
            "params": [{ "address": "server.request.query" }],
            "db_type": [{ "address": "server.db.system" }]
          }
        }
      ],
      "on_match": ["block-sqli"]
    }
  ],
  "rules_compat": [
    {
      "id": "ttr-000-001",
      "name": "Trace Tagging",
      "tags": {
        "type": "security_scanner",
        "category": "attack_attempt"
      },
      "conditions": [
        {
          "parameters": {
            "inputs": [
              {
                "address": "server.request.headers.no_cookies",
                "key_path": ["user-agent"]
              }
            ],
            "regex": "^TraceTagging/v1"
          },
          "operator": "match_regex"
        }
      ],
      "output": {
        "event": true,
        "keep": true,
        "attributes": {
          "some.arbitrary.string.value": { "value": "bad user agent" },
          "some.arbitrary.number.value": { "value": 662607015 },
          "some.arbitrary.compute.value": {
            "address": "server.request.headers.no_cookies",
            "key_path": ["user-agent"]
          }
        }
      },
      "on_match": []
    }
  ],
  "actions": [
    {
      "id": "block-sqli",
      "type": "block",
      "parameters": {
        "status_code": "418",
        "grpc_status_code": "42",
        "type": "auto"
      }
    }
  ]
}
